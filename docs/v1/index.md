**spatialGE.SpatialAutocorrelation**
=====================================

**Description**
---------------

Assess the level of spatial uniformity in gene expression by calculating Moran’s I and/or Geary’s C and qualitatively explore correlations with sample-level metadata (i.e., tissue type, therapy, disease status). It is used to explore the relationship between a clinical (sample-level) variable of interest and the level of gene expression spatial uniformity within a sample.  

The calculation of spatial statistics uses the SThet function of spatialGE and this is followed with multi-sample comparison using spatialGE's compare_SThet. 

**Module Details**
-----------------

* **Authors**: Fridley Lab of the Moffit Cancer Center
* **Adapted as a GenePattern Module by:** Ted Liefeld (jliefeld@cloud.ucsd.edu)
* **Categories**: spatial transcriptomics
* **Source Repo**: [https://github.com/FridleyLab/spatialGE]([https://github.com/genepattern/spatialGE.SpatialAutocorrelation](https://github.com/FridleyLab/spatialGE))
* **Module Source Repo**:  [https://github.com/genepattern/spatialGE.SpatialAutocorrelation](https://github.com/genepattern/spatialGE.SpatialAutocorrelation)
* **Contact**: [edh021@cloud.ucsd.edu](mailto:edh021@cloud.ucsd.edu)

## Methodology

Refer to the <a href="https://fridleylab.github.io/spatialGE/index.html">Fridely lab documentation for SpatialGE</a>.

## References

Ospina, O. E., Wilson C. M., Soupir, A. C., Berglund, A. Smalley, I., Tsai, K. Y., Fridley, B. L. 2022. spatialGE: quantification and visualization of the tumor microenvironment heterogeneity using spatial transcriptomics. Bioinformatics, 38:2645-2647. <a href="https://doi.org/10.1093/bioinformatics/btac145">https://doi.org/10.1093/bioinformatics/btac145</a>

## Parameters

<span style="color: red;">*</span> indicates required parameter

### Autocorrelation Parameters
- <span style="color: red;">*</span>**stlist.rds.input (.rds)**
    - An STList RDS object containing normalized data generated by spatialGE.Preprocessing. 
- <span style="color: red;">*</span>**output filename**
    - Prefix for all output filenames (rds and png).
- <span style="color: red;">*</span>**genes**
    - Comma-separated list of gene names to compute statistics. Do not include any spaces between genes and commas (e.g. "NDRG1,IGKC" not "NDRG1,  IGKC")
- **samples**	
     - Comma-separated list of sample names or indices to compute statistics. If left blank, all samples are used. Do not include any spaces between sample names and commas.
- <span style="color: red;">*</span>**method**	
     - Spatial statistic(s) to estimate: 'moran', 'geary', or both.
- <span style="color: red;">*</span>**neighbors**	
     - Number of neighbors to estimate weights. 
- <span style="color: red;">*</span>**overwrite**	
     - Indicating if previous statistics (if present in the input RDS object) should be overwritten.
       
### Sample Comparison Parameters

- **samplemeta**
    - A string indicating the name of the variable in the clinical data frame. If NULL, uses sample names. 
- <span style="color: red;">*</span>**color.by**
    - The variable in spatial metadata used to color points in the plot. If NULL, each sample is assigned a different color
- <span style="color: red;">*</span>**categorical**
    -Logical indicating whether or not to treat color_by as a categorical variable. Default is TRUE.
- <span style="color: red;">*</span>**color.palette**	
     - A string of a color palette from khroma or RColorBrewer, or a vector with colors with enough elements to plot categories.
- <span style="color: red;">*</span>**point.size**	
     - A number specifying the size of the points in the generated plots. 

       
## Input Files 
 
* **stlist.rds.input**: RDS (R Data Storage)
	+ Description: The input RDS object containing the bioinformatics data.

## Output Files

* **rds file**: An updated version of the STList object provided as input, with spatial autocorrelation statistics added.
* **multi-sample comparison plot(s)**: Plot(s) of the samplemeta versus the calculated statitsics for the named genes

## Version Comments

- **1.0.0** (2023-01-12): Initial draft of documentation.
